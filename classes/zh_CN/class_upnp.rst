:github_url: hide

.. DO NOT EDIT THIS FILE!!!
.. Generated automatically from Godot engine sources.
.. Generator: https://github.com/godotengine/godot/tree/master/doc/tools/make_rst.py.
.. XML source: https://github.com/godotengine/godot/tree/master/modules/upnp/doc_classes/UPNP.xml.

.. _class_UPNP:

UPNP
====

**ç»§æ‰¿ï¼š** :ref:`RefCounted<class_RefCounted>` **<** :ref:`Object<class_Object>`

é€šç”¨å³æ’å³ç”¨ï¼ˆUPnPï¼‰åŠŸèƒ½ï¼Œç”¨äºç½‘ç»œè®¾å¤‡çš„å‘ç°ã€æŸ¥è¯¢åŠç«¯å£æ˜ å°„ã€‚

.. rst-class:: classref-introduction-group

æè¿°
----

This class can be used to discover compatible :ref:`UPNPDevice<class_UPNPDevice>`\ s on the local network and execute commands on them, like managing port mappings (for port forwarding/NAT traversal) and querying the local and remote network IP address. Note that methods on this class are synchronous and block the calling thread.

To forward a specific port (here ``7777``, note both :ref:`discover<class_UPNP_method_discover>` and :ref:`add_port_mapping<class_UPNP_method_add_port_mapping>` can return errors that should be checked):

::

    var upnp = UPNP.new()
    upnp.discover()
    upnp.add_port_mapping(7777)

To close a specific port (e.g. after you have finished using it):

::

    upnp.delete_port_mapping(port)

\ **Note:** UPnP discovery blocks the current thread. To perform discovery without blocking the main thread, use :ref:`Thread<class_Thread>`\ s like this:

::

    # Emitted when UPnP port mapping setup is completed (regardless of success or failure).
    signal upnp_completed(error)
    
    # Replace this with your own server port number between 1024 and 65535.
    const SERVER_PORT = 3928
    var thread = null
    
    func _upnp_setup(server_port):
        # UPNP queries take some time.
        var upnp = UPNP.new()
        var err = upnp.discover()
    
        if err != OK:
            push_error(str(err))
            upnp_completed.emit(err)
            return
    
        if upnp.get_gateway() and upnp.get_gateway().is_valid_gateway():
            upnp.add_port_mapping(server_port, server_port, ProjectSettings.get_setting("application/config/name"), "UDP")
            upnp.add_port_mapping(server_port, server_port, ProjectSettings.get_setting("application/config/name"), "TCP")
            upnp_completed.emit(OK)
    
    func _ready():
        thread = Thread.new()
        thread.start(_upnp_setup.bind(SERVER_PORT))
    
    func _exit_tree():
        # Wait for thread finish here to handle game exit while the thread is running.
        thread.wait_to_finish()

\ **Terminology:** In the context of UPnP networking, "gateway" (or "internet gateway device", short IGD) refers to network devices that allow computers in the local network to access the internet ("wide area network", WAN). These gateways are often also called "routers".

\ **Pitfalls:**\ 

- As explained above, these calls are blocking and shouldn't be run on the main thread, especially as they can block for multiple seconds at a time. Use threading!

- Networking is physical and messy. Packets get lost in transit or get filtered, addresses, free ports and assigned mappings change, and devices may leave or join the network at any time. Be mindful of this, be diligent when checking and handling errors, and handle these gracefully if you can: add clear error UI, timeouts and re-try handling.

- Port mappings may change (and be removed) at any time, and the remote/external IP address of the gateway can change likewise. You should consider re-querying the external IP and try to update/refresh the port mapping periodically (for example, every 5 minutes and on networking failures).

- Not all devices support UPnP, and some users disable UPnP support. You need to handle this (e.g. documenting and requiring the user to manually forward ports, or adding alternative methods of NAT traversal, like a relay/mirror server, or NAT hole punching, STUN/TURN, etc.).

- Consider what happens on mapping conflicts. Maybe multiple users on the same network would like to play your game at the same time, or maybe another application uses the same port. Make the port configurable, and optimally choose a port automatically (re-trying with a different port on failure).

\ **Further reading:** If you want to know more about UPnP (and the Internet Gateway Device (IGD) and Port Control Protocol (PCP) specifically), `Wikipedia <https://en.wikipedia.org/wiki/Universal_Plug_and_Play>`__ is a good first stop, the specification can be found at the `Open Connectivity Foundation <https://openconnectivity.org/developer/specifications/upnp-resources/upnp/>`__ and Godot's implementation is based on the `MiniUPnP client <https://github.com/miniupnp/miniupnp>`__.

.. rst-class:: classref-reftable-group

å±æ€§
----

.. table::
   :widths: auto

   +-----------------------------+-------------------------------------------------------------------------+-----------+
   | :ref:`bool<class_bool>`     | :ref:`discover_ipv6<class_UPNP_property_discover_ipv6>`                 | ``false`` |
   +-----------------------------+-------------------------------------------------------------------------+-----------+
   | :ref:`int<class_int>`       | :ref:`discover_local_port<class_UPNP_property_discover_local_port>`     | ``0``     |
   +-----------------------------+-------------------------------------------------------------------------+-----------+
   | :ref:`String<class_String>` | :ref:`discover_multicast_if<class_UPNP_property_discover_multicast_if>` | ``""``    |
   +-----------------------------+-------------------------------------------------------------------------+-----------+

.. rst-class:: classref-reftable-group

æ–¹æ³•
----

.. table::
   :widths: auto

   +-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | |void|                              | :ref:`add_device<class_UPNP_method_add_device>`\ (\ device\: :ref:`UPNPDevice<class_UPNPDevice>`\ )                                                                                                                                                                            |
   +-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`int<class_int>`               | :ref:`add_port_mapping<class_UPNP_method_add_port_mapping>`\ (\ port\: :ref:`int<class_int>`, port_internal\: :ref:`int<class_int>` = 0, desc\: :ref:`String<class_String>` = "", proto\: :ref:`String<class_String>` = "UDP", duration\: :ref:`int<class_int>` = 0\ ) |const| |
   +-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | |void|                              | :ref:`clear_devices<class_UPNP_method_clear_devices>`\ (\ )                                                                                                                                                                                                                    |
   +-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`int<class_int>`               | :ref:`delete_port_mapping<class_UPNP_method_delete_port_mapping>`\ (\ port\: :ref:`int<class_int>`, proto\: :ref:`String<class_String>` = "UDP"\ ) |const|                                                                                                                     |
   +-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`int<class_int>`               | :ref:`discover<class_UPNP_method_discover>`\ (\ timeout\: :ref:`int<class_int>` = 2000, ttl\: :ref:`int<class_int>` = 2, device_filter\: :ref:`String<class_String>` = "InternetGatewayDevice"\ )                                                                              |
   +-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`UPNPDevice<class_UPNPDevice>` | :ref:`get_device<class_UPNP_method_get_device>`\ (\ index\: :ref:`int<class_int>`\ ) |const|                                                                                                                                                                                   |
   +-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`int<class_int>`               | :ref:`get_device_count<class_UPNP_method_get_device_count>`\ (\ ) |const|                                                                                                                                                                                                      |
   +-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`UPNPDevice<class_UPNPDevice>` | :ref:`get_gateway<class_UPNP_method_get_gateway>`\ (\ ) |const|                                                                                                                                                                                                                |
   +-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`String<class_String>`         | :ref:`query_external_address<class_UPNP_method_query_external_address>`\ (\ ) |const|                                                                                                                                                                                          |
   +-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | |void|                              | :ref:`remove_device<class_UPNP_method_remove_device>`\ (\ index\: :ref:`int<class_int>`\ )                                                                                                                                                                                     |
   +-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | |void|                              | :ref:`set_device<class_UPNP_method_set_device>`\ (\ index\: :ref:`int<class_int>`, device\: :ref:`UPNPDevice<class_UPNPDevice>`\ )                                                                                                                                             |
   +-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. rst-class:: classref-section-separator

----

.. rst-class:: classref-descriptions-group

æšä¸¾
----

.. _enum_UPNP_UPNPResult:

.. rst-class:: classref-enumeration

enum **UPNPResult**: :ref:`ğŸ”—<enum_UPNP_UPNPResult>`

.. _class_UPNP_constant_UPNP_RESULT_SUCCESS:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_SUCCESS** = ``0``

UPNP å‘½ä»¤æˆ–å‘ç°æˆåŠŸã€‚

.. _class_UPNP_constant_UPNP_RESULT_NOT_AUTHORIZED:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_NOT_AUTHORIZED** = ``1``

æœªæˆæƒåœ¨ :ref:`UPNPDevice<class_UPNPDevice>` ä¸Šä½¿ç”¨è¯¥å‘½ä»¤ã€‚å½“ç”¨æˆ·åœ¨å…¶è·¯ç”±å™¨ä¸Šç¦ç”¨ UPNP æ—¶ï¼Œå¯èƒ½ä¼šè¢«è¿”å›ã€‚

.. _class_UPNP_constant_UPNP_RESULT_PORT_MAPPING_NOT_FOUND:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_PORT_MAPPING_NOT_FOUND** = ``2``

åœ¨ç»™å®šçš„ :ref:`UPNPDevice<class_UPNPDevice>` ä¸Šæ²¡æœ‰æ‰¾åˆ°ç»™å®šç«¯å£ã€åè®®ç»„åˆçš„ç«¯å£æ˜ å°„ã€‚

.. _class_UPNP_constant_UPNP_RESULT_INCONSISTENT_PARAMETERS:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_INCONSISTENT_PARAMETERS** = ``3``

å‚æ•°ä¸ä¸€è‡´ã€‚

.. _class_UPNP_constant_UPNP_RESULT_NO_SUCH_ENTRY_IN_ARRAY:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_NO_SUCH_ENTRY_IN_ARRAY** = ``4``

æ•°ç»„ä¸­æ²¡æœ‰æ­¤æ¡ç›®ã€‚å¦‚æœåœ¨ :ref:`UPNPDevice<class_UPNPDevice>` ä¸Šæ²¡æœ‰æ‰¾åˆ°ç»™å®šçš„ç«¯å£ã€åè®®ç»„åˆï¼Œå¯èƒ½ä¼šè¢«è¿”å›ã€‚

.. _class_UPNP_constant_UPNP_RESULT_ACTION_FAILED:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_ACTION_FAILED** = ``5``

æ“ä½œå¤±è´¥ã€‚

.. _class_UPNP_constant_UPNP_RESULT_SRC_IP_WILDCARD_NOT_PERMITTED:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_SRC_IP_WILDCARD_NOT_PERMITTED** = ``6``

:ref:`UPNPDevice<class_UPNPDevice>` ä¸å…è®¸æº IP åœ°å€çš„é€šé…ç¬¦å€¼ã€‚

.. _class_UPNP_constant_UPNP_RESULT_EXT_PORT_WILDCARD_NOT_PERMITTED:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_EXT_PORT_WILDCARD_NOT_PERMITTED** = ``7``

:ref:`UPNPDevice<class_UPNPDevice>` ä¸å…è®¸å¤–éƒ¨ç«¯å£çš„é€šé…ç¬¦å€¼ã€‚

.. _class_UPNP_constant_UPNP_RESULT_INT_PORT_WILDCARD_NOT_PERMITTED:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_INT_PORT_WILDCARD_NOT_PERMITTED** = ``8``

:ref:`UPNPDevice<class_UPNPDevice>` ä¸å…è®¸å†…éƒ¨ç«¯å£çš„é€šé…ç¬¦å€¼ã€‚

.. _class_UPNP_constant_UPNP_RESULT_REMOTE_HOST_MUST_BE_WILDCARD:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_REMOTE_HOST_MUST_BE_WILDCARD** = ``9``

è¿œç¨‹ä¸»æœºå€¼å¿…é¡»æ˜¯é€šé…ç¬¦ã€‚

.. _class_UPNP_constant_UPNP_RESULT_EXT_PORT_MUST_BE_WILDCARD:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_EXT_PORT_MUST_BE_WILDCARD** = ``10``

å¤–éƒ¨ç«¯å£å€¼å¿…é¡»æ˜¯é€šé…ç¬¦ã€‚

.. _class_UPNP_constant_UPNP_RESULT_NO_PORT_MAPS_AVAILABLE:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_NO_PORT_MAPS_AVAILABLE** = ``11``

æ²¡æœ‰å¯ç”¨çš„ç«¯å£æ˜ å°„ã€‚å¦‚æœç«¯å£æ˜ å°„åŠŸèƒ½ä¸å¯ç”¨ï¼Œä¹Ÿå¯èƒ½è¢«è¿”å›ã€‚

.. _class_UPNP_constant_UPNP_RESULT_CONFLICT_WITH_OTHER_MECHANISM:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_CONFLICT_WITH_OTHER_MECHANISM** = ``12``

ä¸å…¶ä»–æœºåˆ¶å†²çªã€‚å¦‚æœä¸€ä¸ªç«¯å£æ˜ å°„ä¸ç°æœ‰çš„å†²çªï¼Œå¯èƒ½ä¼šè¢«è¿”å›ï¼Œè€Œä¸æ˜¯\ :ref:`UPNP_RESULT_CONFLICT_WITH_OTHER_MAPPING<class_UPNP_constant_UPNP_RESULT_CONFLICT_WITH_OTHER_MAPPING>`\ ã€‚

.. _class_UPNP_constant_UPNP_RESULT_CONFLICT_WITH_OTHER_MAPPING:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_CONFLICT_WITH_OTHER_MAPPING** = ``13``

ä¸ç°æœ‰çš„ç«¯å£æ˜ å°„ç›¸å†²çªã€‚

.. _class_UPNP_constant_UPNP_RESULT_SAME_PORT_VALUES_REQUIRED:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_SAME_PORT_VALUES_REQUIRED** = ``14``

å¤–éƒ¨å’Œå†…éƒ¨ç«¯å£å€¼å¿…é¡»ç›¸åŒã€‚

.. _class_UPNP_constant_UPNP_RESULT_ONLY_PERMANENT_LEASE_SUPPORTED:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_ONLY_PERMANENT_LEASE_SUPPORTED** = ``15``

åªæ”¯æŒæ°¸ä¹…ç§Ÿç”¨ã€‚åœ¨æ·»åŠ ç«¯å£æ˜ å°„æ—¶ï¼Œä¸è¦ä½¿ç”¨ ``duration`` å‚æ•°ã€‚

.. _class_UPNP_constant_UPNP_RESULT_INVALID_GATEWAY:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_INVALID_GATEWAY** = ``16``

æ— æ•ˆç½‘å…³ã€‚

.. _class_UPNP_constant_UPNP_RESULT_INVALID_PORT:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_INVALID_PORT** = ``17``

æ— æ•ˆç«¯å£ã€‚

.. _class_UPNP_constant_UPNP_RESULT_INVALID_PROTOCOL:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_INVALID_PROTOCOL** = ``18``

æ— æ•ˆåè®®ã€‚

.. _class_UPNP_constant_UPNP_RESULT_INVALID_DURATION:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_INVALID_DURATION** = ``19``

æ— æ•ˆæŒç»­æ—¶é—´ã€‚

.. _class_UPNP_constant_UPNP_RESULT_INVALID_ARGS:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_INVALID_ARGS** = ``20``

æ— æ•ˆå‚æ•°ã€‚

.. _class_UPNP_constant_UPNP_RESULT_INVALID_RESPONSE:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_INVALID_RESPONSE** = ``21``

æ— æ•ˆå“åº”ã€‚

.. _class_UPNP_constant_UPNP_RESULT_INVALID_PARAM:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_INVALID_PARAM** = ``22``

æ— æ•ˆå‚æ•°ã€‚

.. _class_UPNP_constant_UPNP_RESULT_HTTP_ERROR:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_HTTP_ERROR** = ``23``

HTTP é”™è¯¯ã€‚

.. _class_UPNP_constant_UPNP_RESULT_SOCKET_ERROR:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_SOCKET_ERROR** = ``24``

å¥—æ¥å­—é”™è¯¯ã€‚

.. _class_UPNP_constant_UPNP_RESULT_MEM_ALLOC_ERROR:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_MEM_ALLOC_ERROR** = ``25``

åˆ†é…å†…å­˜æ—¶å‡ºé”™ã€‚

.. _class_UPNP_constant_UPNP_RESULT_NO_GATEWAY:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_NO_GATEWAY** = ``26``

æ²¡æœ‰å¯ç”¨çš„ç½‘å…³ã€‚ä½ å¯èƒ½éœ€è¦å…ˆè°ƒç”¨ :ref:`discover<class_UPNP_method_discover>` ï¼Œå¦åˆ™å‘ç°æ²¡æœ‰æ£€æµ‹åˆ°ä»»ä½•æœ‰æ•ˆçš„ IGDï¼ˆInternetGatewayDevicesï¼‰ã€‚

.. _class_UPNP_constant_UPNP_RESULT_NO_DEVICES:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_NO_DEVICES** = ``27``

æ²¡æœ‰å¯ç”¨çš„è®¾å¤‡ã€‚ä½ å¯èƒ½éœ€è¦å…ˆè°ƒç”¨ :ref:`discover<class_UPNP_method_discover>`\ ï¼Œæˆ–è€…å‘ç°æ²¡æœ‰æ£€æµ‹åˆ°ä»»ä½•æœ‰æ•ˆçš„ :ref:`UPNPDevice<class_UPNPDevice>`\ ã€‚

.. _class_UPNP_constant_UPNP_RESULT_UNKNOWN_ERROR:

.. rst-class:: classref-enumeration-constant

:ref:`UPNPResult<enum_UPNP_UPNPResult>` **UPNP_RESULT_UNKNOWN_ERROR** = ``28``

æœªçŸ¥é”™è¯¯ã€‚

.. rst-class:: classref-section-separator

----

.. rst-class:: classref-descriptions-group

å±æ€§è¯´æ˜
--------

.. _class_UPNP_property_discover_ipv6:

.. rst-class:: classref-property

:ref:`bool<class_bool>` **discover_ipv6** = ``false`` :ref:`ğŸ”—<class_UPNP_property_discover_ipv6>`

.. rst-class:: classref-property-setget

- |void| **set_discover_ipv6**\ (\ value\: :ref:`bool<class_bool>`\ )
- :ref:`bool<class_bool>` **is_discover_ipv6**\ (\ )

å¦‚æœä¸º ``true``\ ï¼Œåˆ™ IPv6 ç”¨äº :ref:`UPNPDevice<class_UPNPDevice>` å‘ç°ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UPNP_property_discover_local_port:

.. rst-class:: classref-property

:ref:`int<class_int>` **discover_local_port** = ``0`` :ref:`ğŸ”—<class_UPNP_property_discover_local_port>`

.. rst-class:: classref-property-setget

- |void| **set_discover_local_port**\ (\ value\: :ref:`int<class_int>`\ )
- :ref:`int<class_int>` **get_discover_local_port**\ (\ )

å¦‚æœä¸º ``0``\ ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é€‰æ‹©ç”¨äºå‘ç°çš„æœ¬åœ°ç«¯å£ã€‚å¦‚æœä¸º ``1``\ ï¼Œå°†ä»æºç«¯å£ 1900 è¿›è¡Œå‘ç°ï¼ˆä¸ç›®çš„ç«¯å£ç›¸åŒï¼‰ã€‚å¦åˆ™ï¼Œå°†ä½¿ç”¨è¯¥å€¼ä½œä¸ºç«¯å£ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UPNP_property_discover_multicast_if:

.. rst-class:: classref-property

:ref:`String<class_String>` **discover_multicast_if** = ``""`` :ref:`ğŸ”—<class_UPNP_property_discover_multicast_if>`

.. rst-class:: classref-property-setget

- |void| **set_discover_multicast_if**\ (\ value\: :ref:`String<class_String>`\ )
- :ref:`String<class_String>` **get_discover_multicast_if**\ (\ )

ç”¨äºå‘ç°çš„å¤šæ’­æ¥å£ã€‚å¦‚æœä¸ºç©ºï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„å¤šæ’­æ¥å£ã€‚

.. rst-class:: classref-section-separator

----

.. rst-class:: classref-descriptions-group

æ–¹æ³•è¯´æ˜
--------

.. _class_UPNP_method_add_device:

.. rst-class:: classref-method

|void| **add_device**\ (\ device\: :ref:`UPNPDevice<class_UPNPDevice>`\ ) :ref:`ğŸ”—<class_UPNP_method_add_device>`

å°†ç»™å®šçš„ :ref:`UPNPDevice<class_UPNPDevice>` æ·»åŠ åˆ°å·²å‘ç°è®¾å¤‡çš„åˆ—è¡¨ä¸­ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UPNP_method_add_port_mapping:

.. rst-class:: classref-method

:ref:`int<class_int>` **add_port_mapping**\ (\ port\: :ref:`int<class_int>`, port_internal\: :ref:`int<class_int>` = 0, desc\: :ref:`String<class_String>` = "", proto\: :ref:`String<class_String>` = "UDP", duration\: :ref:`int<class_int>` = 0\ ) |const| :ref:`ğŸ”—<class_UPNP_method_add_port_mapping>`

æ·»åŠ æ˜ å°„ï¼Œé’ˆå¯¹ç»™å®šçš„åè®® ``proto``\ ï¼ˆ\ ``"TCP"`` æˆ– ``"UDP"``\ ï¼Œé»˜è®¤ä¸º UDPï¼‰ï¼Œå°†é»˜è®¤ç½‘å…³ï¼ˆè§ :ref:`get_gateway<class_UPNP_method_get_gateway>`\ ï¼‰ä¸Šçš„å¤–éƒ¨ç«¯å£ ``port``\ ï¼ˆåœ¨ 1 åˆ° 65535 ä¹‹é—´ï¼Œä¸è¿‡æ¨èä½¿ç”¨ 1024 ä»¥ä¸Šçš„ç«¯å£ï¼‰æ˜ å°„åˆ°æœ¬æœºä¸Šçš„å†…éƒ¨ç«¯å£ ``port_internal``\ ã€‚å¦‚æœè¯¥ç½‘å…³ä¸Šå·²ç»å­˜åœ¨ç»™å®šçš„ç«¯å£ä¸åè®®çš„ç»„åˆï¼Œè¿™ä¸ªæ–¹æ³•ä¼šå°è¯•è¿›è¡Œè¦†ç›–ã€‚å¦‚æœä¸å¸Œæœ›å¦‚æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ :ref:`get_gateway<class_UPNP_method_get_gateway>` æ‰‹åŠ¨è·å–ç½‘å…³ï¼Œè·å–åˆ°åè°ƒç”¨å…¶ :ref:`add_port_mapping<class_UPNP_method_add_port_mapping>` æ–¹æ³•ã€‚è¯·æ³¨æ„ï¼Œä½¿ç”¨ UPnP è½¬å‘å…¬è®¤ç«¯å£ï¼ˆ1024 ä»¥ä¸‹ï¼‰åœ¨æœ‰äº›è®¾å¤‡ä¸Šå¯èƒ½ä¼šå¤±è´¥ã€‚

å¦‚æœç«¯å£çš„æ˜ å°„å·²å­˜åœ¨ï¼Œæœ‰äº›ç½‘å…³è®¾å¤‡å¯èƒ½ä¼šå¯¹å…¶è¿›è¡Œæ›´æ–°ï¼Œæœ‰äº›åˆ™ä¼šå› ä¸ºå†²çªè€Œæ‹’ç»è¿™ä¸ªå‘½ä»¤ï¼Œå°¤å…¶å½“ç°æœ‰ç«¯å£æ˜ å°„ä¸æ˜¯ç”± UPnP åˆ›å»ºçš„ï¼Œæˆ–è€…æŒ‡å‘çš„æ˜¯åˆ«çš„ç½‘ç»œåœ°å€ï¼ˆæˆ–è®¾å¤‡ï¼‰çš„æ—¶å€™ã€‚

å¦‚æœ ``port_internal`` ä¸º ``0``\ ï¼ˆé»˜è®¤ï¼‰ï¼Œè¡¨ç¤ºå†…å¤–éƒ¨ç«¯å£ç›¸åŒï¼ˆä½¿ç”¨ ``port`` çš„å€¼ï¼‰ã€‚

æè¿°ï¼ˆ\ ``desc``\ ï¼‰ä¼šæ˜¾ç¤ºåœ¨ä¸€äº›è·¯ç”±å™¨çš„ç®¡ç†ç•Œé¢ä¸Šï¼Œå¯ä»¥ç”¨æ¥è¯†åˆ«æ·»åŠ æ˜ å°„çš„ç¨‹åºã€‚

æ˜ å°„çš„ç§Ÿèµæ—¶é•¿ ``duration`` å¯ä»¥é€šè¿‡æŒ‡å®šç§’æ•°æ¥é™å®šã€‚é»˜è®¤çš„ ``0`` è¡¨ç¤ºæ²¡æœ‰æ—¶é•¿ï¼Œå³æ°¸ä¹…ç§Ÿèµï¼Œæœ‰äº›è®¾å¤‡åªæ”¯æŒè¿™ç§æ°¸ä¹…ç§Ÿèµã€‚è¯·æ³¨æ„ï¼Œæ— è®ºæ˜¯å¦æ°¸ä¹…éƒ½åªæ˜¯ä¸€ç§è¯·æ±‚ï¼Œç½‘å…³ä»ç„¶å¯ä»¥éšæ—¶ç§»é™¤æ˜ å°„ï¼ˆé€šå¸¸å‘ç”Ÿåœ¨é‡å¯ç½‘å…³åå¤–éƒ¨ IP åœ°å€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¹Ÿæœ‰äº›å‹å·ä¼šåœ¨æ˜ å°„ä¸å†æ´»åŠ¨ï¼Œå³è‹¥å¹²åˆ†é’Ÿæ— æµé‡æ—¶ç§»é™¤ï¼‰ã€‚å¦‚æœé ``0``\ ï¼ˆæ°¸ä¹…ï¼‰ï¼ŒæŠ€æœ¯è§„æ ¼æ‰€å…è®¸çš„èŒƒå›´æ˜¯ ``120``\ ï¼ˆ2 åˆ†é’Ÿï¼‰åˆ° ``86400`` ç§’ï¼ˆ24 å°æ—¶ï¼‰ã€‚

å¯èƒ½çš„è¿”å›å€¼è§ :ref:`UPNPResult<enum_UPNP_UPNPResult>`\ ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UPNP_method_clear_devices:

.. rst-class:: classref-method

|void| **clear_devices**\ (\ ) :ref:`ğŸ”—<class_UPNP_method_clear_devices>`

æ¸…é™¤å·²å‘ç°è®¾å¤‡çš„åˆ—è¡¨ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UPNP_method_delete_port_mapping:

.. rst-class:: classref-method

:ref:`int<class_int>` **delete_port_mapping**\ (\ port\: :ref:`int<class_int>`, proto\: :ref:`String<class_String>` = "UDP"\ ) |const| :ref:`ğŸ”—<class_UPNP_method_delete_port_mapping>`

å¦‚æœé»˜è®¤ç½‘å…³ä¸Šå­˜åœ¨å¯¹ç»™å®šç«¯å£å’Œåè®®ç»„åˆçš„ç«¯å£æ˜ å°„ï¼Œåˆ™å°†å…¶åˆ é™¤ï¼ˆè§ :ref:`get_gateway<class_UPNP_method_get_gateway>`\ ï¼‰ã€‚\ ``port`` å¿…é¡»æ˜¯ 1 å’Œ 65535 ä¹‹é—´çš„æœ‰æ•ˆç«¯å£ï¼Œ\ ``proto`` å¯ä»¥æ˜¯ ``"TCP"`` æˆ– ``"UDP"``\ ã€‚æ‹’ç»çš„åŸå› å¯èƒ½æ˜¯æ˜ å°„æŒ‡å‘å…¶ä»–åœ°å€ã€ç«¯å£ä¸ºå…¬è®¤ç«¯å£ï¼ˆ1024 ä»¥ä¸‹ï¼‰ã€æ˜ å°„ä¸æ˜¯ç”± UPnP æ·»åŠ çš„ã€‚å¯èƒ½çš„è¿”å›å€¼è§ :ref:`UPNPResult<enum_UPNP_UPNPResult>`\ ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UPNP_method_discover:

.. rst-class:: classref-method

:ref:`int<class_int>` **discover**\ (\ timeout\: :ref:`int<class_int>` = 2000, ttl\: :ref:`int<class_int>` = 2, device_filter\: :ref:`String<class_String>` = "InternetGatewayDevice"\ ) :ref:`ğŸ”—<class_UPNP_method_discover>`

å‘ç°æœ¬åœ°çš„ :ref:`UPNPDevice<class_UPNPDevice>`\ ã€‚æ¸…é™¤å…ˆå‰å‘ç°çš„è®¾å¤‡çš„åˆ—è¡¨ã€‚

é»˜è®¤æƒ…å†µä¸‹ä¼šè¿‡æ»¤ IGDï¼ˆInternetGatewayDeviceï¼‰ç±»å‹çš„è®¾å¤‡ï¼Œå› ä¸ºè¿™äº›è®¾å¤‡ç®¡ç†ç«¯å£è½¬å‘ã€‚\ ``timeout`` æ˜¯ç­‰å¾…å“åº”çš„æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ã€‚\ ``ttl`` æ˜¯ç”Ÿå­˜æ—¶é—´ï¼›è¯·åœ¨ä½ çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆçš„æ—¶å€™æ‰ç¢°è¿™ä¸ªå‚æ•°ã€‚

å¯èƒ½çš„è¿”å›å€¼è§ :ref:`UPNPResult<enum_UPNP_UPNPResult>`\ ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UPNP_method_get_device:

.. rst-class:: classref-method

:ref:`UPNPDevice<class_UPNPDevice>` **get_device**\ (\ index\: :ref:`int<class_int>`\ ) |const| :ref:`ğŸ”—<class_UPNP_method_get_device>`

è¿”å›ç»™å®š ``index`` å¤„çš„ :ref:`UPNPDevice<class_UPNPDevice>`\ ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UPNP_method_get_device_count:

.. rst-class:: classref-method

:ref:`int<class_int>` **get_device_count**\ (\ ) |const| :ref:`ğŸ”—<class_UPNP_method_get_device_count>`

è¿”å›å·²å‘ç°çš„ :ref:`UPNPDevice<class_UPNPDevice>` çš„æ•°é‡ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UPNP_method_get_gateway:

.. rst-class:: classref-method

:ref:`UPNPDevice<class_UPNPDevice>` **get_gateway**\ (\ ) |const| :ref:`ğŸ”—<class_UPNP_method_get_gateway>`

è¿”å›é»˜è®¤ç½‘å…³ã€‚è¿™æ˜¯ç¬¬ä¸€ä¸ªå‘ç°çš„\ :ref:`UPNPDevice<class_UPNPDevice>`\ ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„IGDï¼ˆInternetGatewayDeviceï¼‰ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UPNP_method_query_external_address:

.. rst-class:: classref-method

:ref:`String<class_String>` **query_external_address**\ (\ ) |const| :ref:`ğŸ”—<class_UPNP_method_query_external_address>`

è¿”å›é»˜è®¤ç½‘å…³çš„å¤–éƒ¨ :ref:`IP<class_IP>` åœ°å€å­—ç¬¦ä¸²ï¼ˆè§ :ref:`get_gateway<class_UPNP_method_get_gateway>`\ ï¼‰ã€‚é”™è¯¯æ—¶è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UPNP_method_remove_device:

.. rst-class:: classref-method

|void| **remove_device**\ (\ index\: :ref:`int<class_int>`\ ) :ref:`ğŸ”—<class_UPNP_method_remove_device>`

å°† ``index`` å¤„çš„è®¾å¤‡ä»å·²å‘ç°çš„è®¾å¤‡åˆ—è¡¨ä¸­ç§»é™¤ã€‚

.. rst-class:: classref-item-separator

----

.. _class_UPNP_method_set_device:

.. rst-class:: classref-method

|void| **set_device**\ (\ index\: :ref:`int<class_int>`, device\: :ref:`UPNPDevice<class_UPNPDevice>`\ ) :ref:`ğŸ”—<class_UPNP_method_set_device>`

å°† ``index`` å¤„çš„è®¾å¤‡ä»å·²å‘ç°çš„è®¾å¤‡åˆ—è¡¨ä¸­è®¾ç½®ä¸º ``device``\ ã€‚

.. |virtual| replace:: :abbr:`virtual (æœ¬æ–¹æ³•é€šå¸¸éœ€è¦ç”¨æˆ·è¦†ç›–æ‰èƒ½ç”Ÿæ•ˆã€‚)`
.. |const| replace:: :abbr:`const (æœ¬æ–¹æ³•æ— å‰¯ä½œç”¨ï¼Œä¸ä¼šä¿®æ”¹è¯¥å®ä¾‹çš„ä»»ä½•æˆå‘˜å˜é‡ã€‚)`
.. |vararg| replace:: :abbr:`vararg (æœ¬æ–¹æ³•é™¤äº†èƒ½æ¥å—åœ¨æ­¤å¤„æè¿°çš„å‚æ•°å¤–ï¼Œè¿˜èƒ½å¤Ÿç»§ç»­æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ã€‚)`
.. |constructor| replace:: :abbr:`constructor (æœ¬æ–¹æ³•ç”¨äºæ„é€ æŸä¸ªç±»å‹ã€‚)`
.. |static| replace:: :abbr:`static (è°ƒç”¨æœ¬æ–¹æ³•æ— éœ€å®ä¾‹ï¼Œå¯ç›´æ¥ä½¿ç”¨ç±»åè¿›è¡Œè°ƒç”¨ã€‚)`
.. |operator| replace:: :abbr:`operator (æœ¬æ–¹æ³•æè¿°çš„æ˜¯ä½¿ç”¨æœ¬ç±»å‹ä½œä¸ºå·¦æ“ä½œæ•°çš„æœ‰æ•ˆè¿ç®—ç¬¦ã€‚)`
.. |bitfield| replace:: :abbr:`BitField (è¿™ä¸ªå€¼æ˜¯ç”±ä¸‹åˆ—ä½æ ‡å¿—æ„æˆä½æ©ç çš„æ•´æ•°ã€‚)`
.. |void| replace:: :abbr:`void (æ— è¿”å›å€¼ã€‚)`
