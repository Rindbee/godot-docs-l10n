:github_url: hide

.. DO NOT EDIT THIS FILE!!!
.. Generated automatically from Godot engine sources.
.. Generator: https://github.com/godotengine/godot/tree/4.4/doc/tools/make_rst.py.
.. XML source: https://github.com/godotengine/godot/tree/4.4/doc/classes/CompositorEffect.xml.

.. _class_CompositorEffect:

CompositorEffect
================

**å®éªŒæ€§ï¼š** The implementation may change as more of the rendering internals are exposed over time.

**ç»§æ‰¿ï¼š** :ref:`Resource<class_Resource>` **<** :ref:`RefCounted<class_RefCounted>` **<** :ref:`Object<class_Object>`

ç”¨äºåˆ›å»ºè‡ªå®šä¹‰æ¸²æŸ“æ•ˆæœçš„èµ„æºã€‚

.. rst-class:: classref-introduction-group

æè¿°
----

è¿™ç§èµ„æºå®šä¹‰çš„æ˜¯è‡ªå®šä¹‰æ¸²æŸ“æ•ˆæœï¼Œå¯ä»¥é€šè¿‡è§†å£çš„ :ref:`Environment<class_Environment>` åº”ç”¨åˆ° :ref:`Viewport<class_Viewport>` ä¸Šã€‚å¯ä»¥å®ç°åœ¨æ¸²æŸ“ç®¡é“çš„ç»™å®šé˜¶æ®µè¿›è¡Œæ¸²æŸ“æœŸé—´è°ƒç”¨çš„å›è°ƒï¼Œå¹¶å…è®¸æ’å…¥å…¶ä»–é˜¶æ®µã€‚è¯·æ³¨æ„ï¼Œè¯¥å›è°ƒæ˜¯åœ¨æ¸²æŸ“çº¿ç¨‹ä¸Šæ‰§è¡Œçš„ã€‚CompositorEffect æ˜¯æŠ½è±¡åŸºç±»ï¼Œå®ç°ç‰¹å®šçš„æ¸²æŸ“é€»è¾‘å¿…é¡»å¯¹è¯¥ç±»è¿›è¡Œæ‰©å±•ã€‚

.. rst-class:: classref-introduction-group

æ•™ç¨‹
----

- :doc:`åˆæˆå™¨ <../tutorials/rendering/compositor>`

.. rst-class:: classref-reftable-group

å±æ€§
----

.. table::
   :widths: auto

   +---------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | :ref:`bool<class_bool>`                                             | :ref:`access_resolved_color<class_CompositorEffect_property_access_resolved_color>`     |
   +---------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | :ref:`bool<class_bool>`                                             | :ref:`access_resolved_depth<class_CompositorEffect_property_access_resolved_depth>`     |
   +---------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | :ref:`EffectCallbackType<enum_CompositorEffect_EffectCallbackType>` | :ref:`effect_callback_type<class_CompositorEffect_property_effect_callback_type>`       |
   +---------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | :ref:`bool<class_bool>`                                             | :ref:`enabled<class_CompositorEffect_property_enabled>`                                 |
   +---------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | :ref:`bool<class_bool>`                                             | :ref:`needs_motion_vectors<class_CompositorEffect_property_needs_motion_vectors>`       |
   +---------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | :ref:`bool<class_bool>`                                             | :ref:`needs_normal_roughness<class_CompositorEffect_property_needs_normal_roughness>`   |
   +---------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | :ref:`bool<class_bool>`                                             | :ref:`needs_separate_specular<class_CompositorEffect_property_needs_separate_specular>` |
   +---------------------------------------------------------------------+-----------------------------------------------------------------------------------------+

.. rst-class:: classref-reftable-group

æ–¹æ³•
----

.. table::
   :widths: auto

   +--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | |void| | :ref:`_render_callback<class_CompositorEffect_private_method__render_callback>`\ (\ effect_callback_type\: :ref:`int<class_int>`, render_data\: :ref:`RenderData<class_RenderData>`\ ) |virtual| |
   +--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. rst-class:: classref-section-separator

----

.. rst-class:: classref-descriptions-group

æšä¸¾
----

.. _enum_CompositorEffect_EffectCallbackType:

.. rst-class:: classref-enumeration

enum **EffectCallbackType**: :ref:`ğŸ”—<enum_CompositorEffect_EffectCallbackType>`

.. _class_CompositorEffect_constant_EFFECT_CALLBACK_TYPE_PRE_OPAQUE:

.. rst-class:: classref-enumeration-constant

:ref:`EffectCallbackType<enum_CompositorEffect_EffectCallbackType>` **EFFECT_CALLBACK_TYPE_PRE_OPAQUE** = ``0``

å›è°ƒåœ¨ä¸é€æ˜æ¸²æŸ“é˜¶æ®µä¹‹å‰è°ƒç”¨ï¼Œä½†åœ¨æ·±åº¦å‰ç½®é˜¶æ®µä¹‹åï¼ˆå¦‚æœé€‚ç”¨ï¼‰ã€‚

.. _class_CompositorEffect_constant_EFFECT_CALLBACK_TYPE_POST_OPAQUE:

.. rst-class:: classref-enumeration-constant

:ref:`EffectCallbackType<enum_CompositorEffect_EffectCallbackType>` **EFFECT_CALLBACK_TYPE_POST_OPAQUE** = ``1``

å›è°ƒåœ¨ä¸é€æ˜æ¸²æŸ“é˜¶æ®µä¹‹åè°ƒç”¨ï¼Œä½†åœ¨æ¸²æŸ“å¤©ç©ºä¹‹å‰ã€‚

.. _class_CompositorEffect_constant_EFFECT_CALLBACK_TYPE_POST_SKY:

.. rst-class:: classref-enumeration-constant

:ref:`EffectCallbackType<enum_CompositorEffect_EffectCallbackType>` **EFFECT_CALLBACK_TYPE_POST_SKY** = ``2``

å›è°ƒåœ¨æ¸²æŸ“å¤©ç©ºä¹‹åè°ƒç”¨ï¼Œä½†åœ¨åˆ›å»ºåå°ç¼“å†²ä¹‹å‰ï¼ˆå¦‚æœå¯ç”¨ï¼Œåˆ™åœ¨æ¬¡è¡¨é¢æ•£å°„å’Œ/æˆ–å±å¹•ç©ºé—´åå°„ä¹‹å‰ï¼‰ã€‚

.. _class_CompositorEffect_constant_EFFECT_CALLBACK_TYPE_PRE_TRANSPARENT:

.. rst-class:: classref-enumeration-constant

:ref:`EffectCallbackType<enum_CompositorEffect_EffectCallbackType>` **EFFECT_CALLBACK_TYPE_PRE_TRANSPARENT** = ``3``

å›è°ƒåœ¨é€æ˜æ¸²æŸ“é˜¶æ®µä¹‹å‰è°ƒç”¨ï¼Œä½†åœ¨æ¸²æŸ“å¤©ç©ºå’Œåˆ›å»ºåå°ç¼“å†²åŒºä¹‹åã€‚

.. _class_CompositorEffect_constant_EFFECT_CALLBACK_TYPE_POST_TRANSPARENT:

.. rst-class:: classref-enumeration-constant

:ref:`EffectCallbackType<enum_CompositorEffect_EffectCallbackType>` **EFFECT_CALLBACK_TYPE_POST_TRANSPARENT** = ``4``

å›è°ƒåœ¨é€æ˜æ¸²æŸ“é˜¶æ®µä¹‹åè°ƒç”¨ï¼Œä½†åœ¨å†…ç½®åæœŸæ•ˆæœå’Œè¾“å‡ºåˆ°æ¸²æŸ“ç›®æ ‡ä¹‹å‰ã€‚

.. _class_CompositorEffect_constant_EFFECT_CALLBACK_TYPE_MAX:

.. rst-class:: classref-enumeration-constant

:ref:`EffectCallbackType<enum_CompositorEffect_EffectCallbackType>` **EFFECT_CALLBACK_TYPE_MAX** = ``5``

ä»£è¡¨ :ref:`EffectCallbackType<enum_CompositorEffect_EffectCallbackType>` æšä¸¾çš„å¤§å°ã€‚

.. rst-class:: classref-section-separator

----

.. rst-class:: classref-descriptions-group

å±æ€§è¯´æ˜
--------

.. _class_CompositorEffect_property_access_resolved_color:

.. rst-class:: classref-property

:ref:`bool<class_bool>` **access_resolved_color** :ref:`ğŸ”—<class_CompositorEffect_property_access_resolved_color>`

.. rst-class:: classref-property-setget

- |void| **set_access_resolved_color**\ (\ value\: :ref:`bool<class_bool>`\ )
- :ref:`bool<class_bool>` **get_access_resolved_color**\ (\ )

å¦‚æœä¸º ``true`` å¹¶ä¸”å¯ç”¨äº† MSAAï¼Œåˆ™ä¼šåœ¨æ‰§è¡Œè¯¥æ•ˆæœä¹‹å‰è§¦å‘é¢œè‰²ç¼“å†²çš„è§£æã€‚

\ **æ³¨æ„ï¼š**\ è¦åœ¨ :ref:`_render_callback()<class_CompositorEffect_private_method__render_callback>` ä¸­è®¿é—®è§£æåçš„ç¼“å†²ï¼Œè¯·ä½¿ç”¨ï¼š

::

    var render_scene_buffers = render_data.get_render_scene_buffers()
    var color_buffer = render_scene_buffers.get_texture("render_buffers", "color")

.. rst-class:: classref-item-separator

----

.. _class_CompositorEffect_property_access_resolved_depth:

.. rst-class:: classref-property

:ref:`bool<class_bool>` **access_resolved_depth** :ref:`ğŸ”—<class_CompositorEffect_property_access_resolved_depth>`

.. rst-class:: classref-property-setget

- |void| **set_access_resolved_depth**\ (\ value\: :ref:`bool<class_bool>`\ )
- :ref:`bool<class_bool>` **get_access_resolved_depth**\ (\ )

å¦‚æœä¸º ``true`` å¹¶ä¸”å¯ç”¨äº† MSAAï¼Œåˆ™ä¼šåœ¨æ‰§è¡Œè¯¥æ•ˆæœä¹‹å‰è§¦å‘æ·±åº¦ç¼“å†²çš„è§£æã€‚

\ **æ³¨æ„ï¼š**\ è¦åœ¨ :ref:`_render_callback()<class_CompositorEffect_private_method__render_callback>` ä¸­è®¿é—®è§£æåçš„ç¼“å†²ï¼Œè¯·ä½¿ç”¨ï¼š

::

    var render_scene_buffers = render_data.get_render_scene_buffers()
    var depth_buffer = render_scene_buffers.get_texture("render_buffers", "depth")

.. rst-class:: classref-item-separator

----

.. _class_CompositorEffect_property_effect_callback_type:

.. rst-class:: classref-property

:ref:`EffectCallbackType<enum_CompositorEffect_EffectCallbackType>` **effect_callback_type** :ref:`ğŸ”—<class_CompositorEffect_property_effect_callback_type>`

.. rst-class:: classref-property-setget

- |void| **set_effect_callback_type**\ (\ value\: :ref:`EffectCallbackType<enum_CompositorEffect_EffectCallbackType>`\ )
- :ref:`EffectCallbackType<enum_CompositorEffect_EffectCallbackType>` **get_effect_callback_type**\ (\ )

å®ç°çš„æ•ˆæœç±»å‹ï¼Œå†³å®šåœ¨æ¸²æŸ“çš„å“ªä¸ªé˜¶æ®µè°ƒç”¨å›è°ƒã€‚

.. rst-class:: classref-item-separator

----

.. _class_CompositorEffect_property_enabled:

.. rst-class:: classref-property

:ref:`bool<class_bool>` **enabled** :ref:`ğŸ”—<class_CompositorEffect_property_enabled>`

.. rst-class:: classref-property-setget

- |void| **set_enabled**\ (\ value\: :ref:`bool<class_bool>`\ )
- :ref:`bool<class_bool>` **get_enabled**\ (\ )

å¦‚æœä¸º ``true``\ ï¼Œåˆ™è¯¥æ¸²æŸ“æ•ˆæœä¼šåº”ç”¨åˆ°æ‰€æœ‰ç›¸å…³è§†å£ã€‚

.. rst-class:: classref-item-separator

----

.. _class_CompositorEffect_property_needs_motion_vectors:

.. rst-class:: classref-property

:ref:`bool<class_bool>` **needs_motion_vectors** :ref:`ğŸ”—<class_CompositorEffect_property_needs_motion_vectors>`

.. rst-class:: classref-property-setget

- |void| **set_needs_motion_vectors**\ (\ value\: :ref:`bool<class_bool>`\ )
- :ref:`bool<class_bool>` **get_needs_motion_vectors**\ (\ )

å¦‚æœä¸º ``true``\ ï¼Œåˆ™ä¼šåœ¨ä¸é€æ˜æ¸²æŸ“çŠ¶æ€ä¸‹è§¦å‘è¿åŠ¨å‘é‡çš„è®¡ç®—ã€‚

\ **æ³¨æ„ï¼š**\ è¦åœ¨ :ref:`_render_callback()<class_CompositorEffect_private_method__render_callback>` ä¸­è®¿é—®è¿åŠ¨å‘é‡ç¼“å†²ï¼Œè¯·ä½¿ç”¨ï¼š

::

    var render_scene_buffers = render_data.get_render_scene_buffers()
    var motion_buffer = render_scene_buffers.get_velocity_texture()

.. rst-class:: classref-item-separator

----

.. _class_CompositorEffect_property_needs_normal_roughness:

.. rst-class:: classref-property

:ref:`bool<class_bool>` **needs_normal_roughness** :ref:`ğŸ”—<class_CompositorEffect_property_needs_normal_roughness>`

.. rst-class:: classref-property-setget

- |void| **set_needs_normal_roughness**\ (\ value\: :ref:`bool<class_bool>`\ )
- :ref:`bool<class_bool>` **get_needs_normal_roughness**\ (\ )

å¦‚æœä¸º ``true``\ ï¼Œåˆ™ä¼šåœ¨æ·±åº¦é¢„é˜¶æ®µä¸­è¾“å‡ºæ³•çº¿å’Œç²—ç³™åº¦æ•°æ®ï¼Œä»…é€‚ç”¨äº Forward+ æ¸²æŸ“å™¨ã€‚

\ **æ³¨æ„ï¼š**\ åœ¨ :ref:`_render_callback()<class_CompositorEffect_private_method__render_callback>` ä¸­è®¿é—®ç²—ç³™åº¦ç¼“å†²ï¼š

::

    var render_scene_buffers = render_data.get_render_scene_buffers()
    var roughness_buffer = render_scene_buffers.get_texture("forward_clustered", "normal_roughness")

åŸå§‹çš„æ³•çº¿å’Œç²—ç³™åº¦ç¼“å†²ä½¿ç”¨ä¼˜åŒ–æ ¼å¼å­˜å‚¨ï¼Œä¸ç©ºé—´ç€è‰²å™¨ä¸­çš„æ ¼å¼ä¸åŒã€‚å¯¹ç¼“å†²é‡‡æ ·æ—¶å¿…é¡»åº”ç”¨è½¬æ¢å‡½æ•°ã€‚è¯·ä½¿ç”¨ä»\ `è¿™é‡Œ <https://github.com/godotengine/godot/blob/da5f39889f155658cef7f7ec3cc1abb94e17d815/servers/rendering/renderer_rd/shaders/forward_clustered/scene_forward_clustered_inc.glsl#L334-L341>`__\ å¤åˆ¶çš„å‡½æ•°ï¼š

::

    vec4 normal_roughness_compatibility(vec4 p_normal_roughness) {
        float roughness = p_normal_roughness.w;
        if (roughness > 0.5) {
            roughness = 1.0 - roughness;
        }
        roughness /= (127.0 / 255.0);
        return vec4(normalize(p_normal_roughness.xyz * 2.0 - 1.0) * 0.5 + 0.5, roughness);
    }

.. rst-class:: classref-item-separator

----

.. _class_CompositorEffect_property_needs_separate_specular:

.. rst-class:: classref-property

:ref:`bool<class_bool>` **needs_separate_specular** :ref:`ğŸ”—<class_CompositorEffect_property_needs_separate_specular>`

.. rst-class:: classref-property-setget

- |void| **set_needs_separate_specular**\ (\ value\: :ref:`bool<class_bool>`\ )
- :ref:`bool<class_bool>` **get_needs_separate_specular**\ (\ )

å¦‚æœä¸º ``true``\ ï¼Œåˆ™ä¼šè§¦å‘é•œé¢åå°„æ•°æ®æ¸²æŸ“è‡³ç‹¬ç«‹ç¼“å†²ï¼Œåœ¨åº”ç”¨æ•ˆæœåè¿›è¡Œæ··åˆï¼Œä»…é€‚ç”¨äº Forward+ æ¸²æŸ“å™¨ã€‚

.. rst-class:: classref-section-separator

----

.. rst-class:: classref-descriptions-group

æ–¹æ³•è¯´æ˜
--------

.. _class_CompositorEffect_private_method__render_callback:

.. rst-class:: classref-method

|void| **_render_callback**\ (\ effect_callback_type\: :ref:`int<class_int>`, render_data\: :ref:`RenderData<class_RenderData>`\ ) |virtual| :ref:`ğŸ”—<class_CompositorEffect_private_method__render_callback>`

è¯·ä½¿ç”¨è‡ªå®šä¹‰çš„æ¸²æŸ“ä»£ç å®ç°è¯¥æ–¹æ³•ã€‚\ ``effect_callback_type`` åº”å½“ä¸ :ref:`effect_callback_type<class_CompositorEffect_property_effect_callback_type>` ä¸­æŒ‡å®šçš„æ•ˆæœå›è°ƒç±»å‹ä¸€è‡´ã€‚å¯ä»¥é€šè¿‡ ``render_data`` è®¿é—®æ¸²æŸ“çŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€åªæœ‰åœ¨æ¸²æŸ“æ—¶æœ‰æ•ˆï¼Œä¸åº”è¯¥å­˜å‚¨ã€‚

.. |virtual| replace:: :abbr:`virtual (æœ¬æ–¹æ³•é€šå¸¸éœ€è¦ç”¨æˆ·è¦†ç›–æ‰èƒ½ç”Ÿæ•ˆã€‚)`
.. |const| replace:: :abbr:`const (æœ¬æ–¹æ³•æ— å‰¯ä½œç”¨ï¼Œä¸ä¼šä¿®æ”¹è¯¥å®ä¾‹çš„ä»»ä½•æˆå‘˜å˜é‡ã€‚)`
.. |vararg| replace:: :abbr:`vararg (æœ¬æ–¹æ³•é™¤äº†èƒ½æ¥å—åœ¨æ­¤å¤„æè¿°çš„å‚æ•°å¤–ï¼Œè¿˜èƒ½å¤Ÿç»§ç»­æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ã€‚)`
.. |constructor| replace:: :abbr:`constructor (æœ¬æ–¹æ³•ç”¨äºæ„é€ æŸä¸ªç±»å‹ã€‚)`
.. |static| replace:: :abbr:`static (è°ƒç”¨æœ¬æ–¹æ³•æ— éœ€å®ä¾‹ï¼Œå¯ç›´æ¥ä½¿ç”¨ç±»åè¿›è¡Œè°ƒç”¨ã€‚)`
.. |operator| replace:: :abbr:`operator (æœ¬æ–¹æ³•æè¿°çš„æ˜¯ä½¿ç”¨æœ¬ç±»å‹ä½œä¸ºå·¦æ“ä½œæ•°çš„æœ‰æ•ˆè¿ç®—ç¬¦ã€‚)`
.. |bitfield| replace:: :abbr:`BitField (è¿™ä¸ªå€¼æ˜¯ç”±ä¸‹åˆ—ä½æ ‡å¿—æ„æˆä½æ©ç çš„æ•´æ•°ã€‚)`
.. |void| replace:: :abbr:`void (æ— è¿”å›å€¼ã€‚)`
